
id: drupal-module-acquia-connector-access-bypass
info:
  name: drupal-module-acquia-connector-access-bypass
  author: Bishopfox
  severity: medium
  description: "Acquia Connector facilitates sending certain telemetry data to Acquia for the purposes of analysis. The module automates the collection of site information to speed support communication and issue resolution. It is required for use with the Acquia Insight service. The module does not properly enforce access control in a specific case, which can lead to disclosing information. The vulnerability is mitigated by requiring the module diff feature to be enabled. This feature is enabled by default."
  reference:
    - https://www.drupal.org/sa-contrib-2019-014
  metadata:
    security-risk: "Moderately critical 12âˆ•25 AC:Basic/A:None/CI:Some/II:None/E:Theoretical/TD:Default"
    vulnerability: "access-bypass"
    fofa-query: "/sites/all/modules/acquia-connector/"
    google-query: "inurl:'/sites/all/modules/acquia-connector/"
    impact: medium
    type: indicator
    created-at: '0001-01-01T00:00:00Z'
  tags: drupal

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/sites/all/modules/acquia-connector/acquia-connector.info"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'version = "([0-9]+\.x-[0-9]+\.[0-9]+)"'
      - type: status
        status:
          - 200
      - type: word
        words:
          - 'acquia-connector'
        part: body

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'version = "([0-9]+\.x-[0-9]+\.[0-9]+)"'

      - type: dsl
        dsl:
         - compare-versions(version, '<= 1.16.0')
