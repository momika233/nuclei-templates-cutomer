
id: drupal-module-link-click-count-unsupported
info:
  name: drupal-module-link-click-count-unsupported
  author: Bishopfox
  severity: medium
  description: "The Link Click Count module helps you to monitor the traffic to your website by creating link fields. These link fields can be individual links or internal/external links that can be added to the content type. The security team is marking this module unsupported. There is a known security issue with the module that has not been fixed by the maintainer. The security team takes action in cases like this without regard to the severity of the security issue in question. If you would like to maintain this module, please read: https://www.drupal.org/node/251466   All projects that are being marked unsupported are given a score of critical. Code that is no longer maintained poses a threat to securing sites."
  reference:
    - https://www.drupal.org/sa-contrib-2017-094
  metadata:
    security-risk: "Critical 18âˆ•25 AC:None/A:None/CI:Some/II:Some/E:Proof/TD:Default"
    vulnerability: "unsupported"
    fofa-query: "/sites/all/modules/link-click-count/"
    google-query: "inurl:'/sites/all/modules/link-click-count/"
    impact: medium
    type: indicator
    created-at: '0001-01-01T00:00:00Z'
  tags: drupal

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/sites/all/modules/link-click-count/link-click-count.info"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'version = "([0-9]+\.x-[0-9]+\.[0-9]+)"'
      - type: status
        status:
          - 200
      - type: word
        words:
          - 'link-click-count'
        part: body

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'version = "([0-9]+\.x-[0-9]+\.[0-9]+)"'

      - type: dsl
        dsl:
         - compare-versions(version, '<= 99.x-99.99')
